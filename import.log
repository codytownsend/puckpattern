2025-05-06 21:22:28,882 - __main__ - INFO - Starting import: teams
2025-05-06 21:22:28,883 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:22:29,085 - app.data_import.nhl_data_fetcher - ERROR - Error fetching https://api-web.nhle.com/v1/team: 404 Client Error: Not Found for url: https://api-web.nhle.com/v1/team
2025-05-06 21:22:29,322 - app.data_import.nhl_data_fetcher - ERROR - Error fetching https://api-web.nhle.com/v1/https://api-web.nhle.com/v1/standings/now: 400 Client Error: Bad Request for url: https://api-web.nhle.com/v1/https://api-web.nhle.com/v1/standings/now
2025-05-06 21:22:29,323 - app.data_import.import_service - INFO - Imported 0 teams
2025-05-06 21:22:29,324 - __main__ - ERROR - Error during import: object of type 'int' has no len()
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 34, in import_teams
    return len(teams)
TypeError: object of type 'int' has no len()
2025-05-06 21:35:37,620 - __main__ - INFO - Starting import: teams
2025-05-06 21:35:37,621 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:35:39,279 - __main__ - ERROR - Error during import: Could not determine join condition between parent/child tables on relationship ShotEvent.event - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2437, in _determine_joins
    self.primaryjoin = join_condition(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/util.py", line 123, in join_condition
    return Join._join_condition(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/selectable.py", line 1431, in _join_condition
    cls._joincond_trim_constraints(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/selectable.py", line 1576, in _joincond_trim_constraints
    raise exc.AmbiguousForeignKeysError(
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'shot_events' and 'game_events'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2955, in query
    return self._query_cls(entities, self, **kwargs)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 276, in __init__
    self._set_entities(entities)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 288, in _set_entities
    self._raw_columns = [
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 289, in <listcomp>
    coercions.expect(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 388, in expect
    insp._post_inspect
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1658, in do_init
    self._setup_join_conditions()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1898, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2324, in __init__
    self._determine_joins()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2481, in _determine_joins
    raise sa_exc.AmbiguousForeignKeysError(
sqlalchemy.exc.AmbiguousForeignKeysError: Could not determine join condition between parent/child tables on relationship ShotEvent.event - there are multiple foreign key paths linking the tables.  Specify the 'foreign_keys' argument, providing a list of those columns which should be counted as containing a foreign key reference to the parent table.
2025-05-06 21:41:32,712 - __main__ - INFO - Starting import: teams
2025-05-06 21:41:32,713 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:41:34,342 - __main__ - ERROR - Error during import: Could not locate any relevant foreign key columns for primary join condition 'power_plays.game_id = game_events.game_id AND power_plays.team_id = game_events.team_id AND power_plays.start_time <= game_events.time_elapsed AND power_plays.end_time >= game_events.time_elapsed AND power_plays.period = game_events.period' on relationship PowerPlay.events.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or are annotated in the join condition with the foreign() annotation.
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2955, in query
    return self._query_cls(entities, self, **kwargs)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 276, in __init__
    self._set_entities(entities)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 288, in _set_entities
    self._raw_columns = [
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 289, in <listcomp>
    coercions.expect(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/coercions.py", line 388, in expect
    insp._post_inspect
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 1257, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2724, in _post_inspect
    self._check_configure()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2401, in _check_configure
    _configure_registries({self.registry}, cascade=True)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4214, in _configure_registries
    _do_configure_registries(registries, cascade)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 4255, in _do_configure_registries
    mapper._post_configure_properties()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/mapper.py", line 2418, in _post_configure_properties
    prop.init()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/interfaces.py", line 589, in init
    self.do_init()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1658, in do_init
    self._setup_join_conditions()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 1898, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2333, in __init__
    self._check_foreign_cols(self.primaryjoin, True)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/relationships.py", line 2976, in _check_foreign_cols
    raise sa_exc.ArgumentError(err)
sqlalchemy.exc.ArgumentError: Could not locate any relevant foreign key columns for primary join condition 'power_plays.game_id = game_events.game_id AND power_plays.team_id = game_events.team_id AND power_plays.start_time <= game_events.time_elapsed AND power_plays.end_time >= game_events.time_elapsed AND power_plays.period = game_events.period' on relationship PowerPlay.events.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or are annotated in the join condition with the foreign() annotation.
2025-05-06 21:43:28,071 - __main__ - INFO - Starting import: teams
2025-05-06 21:43:28,072 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:43:29,654 - __main__ - ERROR - Error during import: (psycopg2.OperationalError) could not translate host name "db.ffrtuszjaacoehnnmeun.supabase.co" to address: nodename nor servname provided, or not known

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "db.ffrtuszjaacoehnnmeun.supabase.co" to address: nodename nor servname provided, or not known


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2858, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3274, in connect
    return self._connection_cls(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "db.ffrtuszjaacoehnnmeun.supabase.co" to address: nodename nor servname provided, or not known

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-06 21:48:00,404 - __main__ - INFO - Starting import: teams
2025-05-06 21:48:00,404 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:48:01,921 - __main__ - ERROR - Error during import: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "postgres" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "postgres" does not exist


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2858, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2241, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2110, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
  File "<string>", line 2, in _connection_for_bind
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1189, in _connection_for_bind
    conn = bind.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3274, in connect
    return self._connection_cls(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3298, in raw_connection
    return self.pool.connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 713, in checkout
    rec = pool._do_get()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    return self._create_connection()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 675, in __init__
    self.__connect()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 901, in __connect
    with util.safe_reraise():
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 897, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 625, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  role "postgres" does not exist

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-05-06 21:49:49,556 - __main__ - INFO - Starting import: teams
2025-05-06 21:49:49,556 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:49:51,327 - __main__ - ERROR - Error during import: (psycopg2.errors.UndefinedTable) relation "teams" does not exist
LINE 2: FROM teams 
             ^

[SQL: SELECT teams.id AS teams_id, teams.team_id AS teams_team_id, teams.name AS teams_name, teams.abbreviation AS teams_abbreviation, teams.created_at AS teams_created_at, teams.updated_at AS teams_updated_at, teams.city_name AS teams_city_name, teams.team_name AS teams_team_name, teams.division AS teams_division, teams.conference AS teams_conference, teams.franchise_id AS teams_franchise_id, teams.venue_name AS teams_venue_name, teams.venue_city AS teams_venue_city, teams.official_site_url AS teams_official_site_url, teams.active AS teams_active 
FROM teams 
WHERE teams.team_id = %(team_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'team_id_1': 32, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "teams" does not exist
LINE 2: FROM teams 
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2858, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "teams" does not exist
LINE 2: FROM teams 
             ^

[SQL: SELECT teams.id AS teams_id, teams.team_id AS teams_team_id, teams.name AS teams_name, teams.abbreviation AS teams_abbreviation, teams.created_at AS teams_created_at, teams.updated_at AS teams_updated_at, teams.city_name AS teams_city_name, teams.team_name AS teams_team_name, teams.division AS teams_division, teams.conference AS teams_conference, teams.franchise_id AS teams_franchise_id, teams.venue_name AS teams_venue_name, teams.venue_city AS teams_venue_city, teams.official_site_url AS teams_official_site_url, teams.active AS teams_active 
FROM teams 
WHERE teams.team_id = %(team_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'team_id_1': 32, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-06 21:56:02,844 - __main__ - INFO - Starting import: teams
2025-05-06 21:56:02,844 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:56:04,237 - __main__ - ERROR - Error during import: (psycopg2.errors.UndefinedFunction) operator does not exist: character varying = integer
LINE 3: WHERE teams.team_id = 32 
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT teams.id AS teams_id, teams.team_id AS teams_team_id, teams.name AS teams_name, teams.abbreviation AS teams_abbreviation, teams.created_at AS teams_created_at, teams.updated_at AS teams_updated_at, teams.city_name AS teams_city_name, teams.team_name AS teams_team_name, teams.division AS teams_division, teams.conference AS teams_conference, teams.franchise_id AS teams_franchise_id, teams.venue_name AS teams_venue_name, teams.venue_city AS teams_venue_city, teams.official_site_url AS teams_official_site_url, teams.active AS teams_active 
FROM teams 
WHERE teams.team_id = %(team_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'team_id_1': 32, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: operator does not exist: character varying = integer
LINE 3: WHERE teams.team_id = 32 
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 124, in main
    count = import_teams(db)
  File "/Users/codytownsend/puckpattern/backend/scripts/data_import.py", line 33, in import_teams
    teams = service.import_teams()
  File "/Users/codytownsend/puckpattern/backend/app/data_import/import_service.py", line 59, in import_teams
    existing = self.db.query(Team).filter(Team.team_id == team_id).first()
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/query.py", line 2858, in _iter
    result: Union[ScalarResult[_T], Result[_T]] = self.session.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2365, in execute
    return self._execute_internal(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1416, in execute
    return meth(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1638, in _execute_clauseelement
    ret = self._execute_context(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1843, in _execute_context
    return self._exec_single_context(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1983, in _exec_single_context
    self._handle_dbapi_exception(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2352, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1964, in _exec_single_context
    self.dialect.do_execute(
  File "/Users/codytownsend/puckpattern/.venv/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 945, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) operator does not exist: character varying = integer
LINE 3: WHERE teams.team_id = 32 
                            ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT teams.id AS teams_id, teams.team_id AS teams_team_id, teams.name AS teams_name, teams.abbreviation AS teams_abbreviation, teams.created_at AS teams_created_at, teams.updated_at AS teams_updated_at, teams.city_name AS teams_city_name, teams.team_name AS teams_team_name, teams.division AS teams_division, teams.conference AS teams_conference, teams.franchise_id AS teams_franchise_id, teams.venue_name AS teams_venue_name, teams.venue_city AS teams_venue_city, teams.official_site_url AS teams_official_site_url, teams.active AS teams_active 
FROM teams 
WHERE teams.team_id = %(team_id_1)s 
 LIMIT %(param_1)s]
[parameters: {'team_id_1': 32, 'param_1': 1}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-05-06 21:58:07,176 - __main__ - INFO - Starting import: teams
2025-05-06 21:58:07,176 - app.data_import.import_service - INFO - Importing NHL teams
2025-05-06 21:58:08,612 - app.data_import.import_service - INFO - Imported 59 teams
2025-05-06 21:58:08,612 - __main__ - INFO - Imported [<app.models.base.Team object at 0x108b9ef20>, <app.models.base.Team object at 0x108b9eef0>, <app.models.base.Team object at 0x108ecd9c0>, <app.models.base.Team object at 0x108ecf3a0>, <app.models.base.Team object at 0x108ecfd60>, <app.models.base.Team object at 0x108ecfe50>, <app.models.base.Team object at 0x108ecfac0>, <app.models.base.Team object at 0x108ecfa00>, <app.models.base.Team object at 0x108ecf430>, <app.models.base.Team object at 0x108ecf550>, <app.models.base.Team object at 0x108ecf970>, <app.models.base.Team object at 0x108ece530>, <app.models.base.Team object at 0x108ecf910>, <app.models.base.Team object at 0x108f18b80>, <app.models.base.Team object at 0x108f192d0>, <app.models.base.Team object at 0x108f18d30>, <app.models.base.Team object at 0x108f19330>, <app.models.base.Team object at 0x108f18f70>, <app.models.base.Team object at 0x108f190f0>, <app.models.base.Team object at 0x108f193c0>, <app.models.base.Team object at 0x108f18eb0>, <app.models.base.Team object at 0x108f192a0>, <app.models.base.Team object at 0x108f191e0>, <app.models.base.Team object at 0x108f191b0>, <app.models.base.Team object at 0x108f19240>, <app.models.base.Team object at 0x108f193f0>, <app.models.base.Team object at 0x108f19420>, <app.models.base.Team object at 0x108f19450>, <app.models.base.Team object at 0x108f19480>, <app.models.base.Team object at 0x108f194b0>, <app.models.base.Team object at 0x108f194e0>, <app.models.base.Team object at 0x108f19510>, <app.models.base.Team object at 0x108f19540>, <app.models.base.Team object at 0x108f19570>, <app.models.base.Team object at 0x108f19090>, <app.models.base.Team object at 0x108f18d00>, <app.models.base.Team object at 0x108f18e50>, <app.models.base.Team object at 0x108f18f40>, <app.models.base.Team object at 0x108f19660>, <app.models.base.Team object at 0x108f19690>, <app.models.base.Team object at 0x108f196c0>, <app.models.base.Team object at 0x108f196f0>, <app.models.base.Team object at 0x108f19720>, <app.models.base.Team object at 0x108f19750>, <app.models.base.Team object at 0x108f19840>, <app.models.base.Team object at 0x108f19210>, <app.models.base.Team object at 0x108f19300>, <app.models.base.Team object at 0x108f19390>, <app.models.base.Team object at 0x108f195a0>, <app.models.base.Team object at 0x108f197b0>, <app.models.base.Team object at 0x108f197e0>, <app.models.base.Team object at 0x108f195d0>, <app.models.base.Team object at 0x108f19270>, <app.models.base.Team object at 0x108f19120>, <app.models.base.Team object at 0x108f19030>, <app.models.base.Team object at 0x108f199c0>, <app.models.base.Team object at 0x108f199f0>, <app.models.base.Team object at 0x108f19a20>, <app.models.base.Team object at 0x108f19a50>] teams
2025-05-06 21:58:08,612 - __main__ - INFO - Import completed in 1.44 seconds
